<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blacksheep — by CAVS</title>
  <meta name="description" content="Blacksheep by CAVS — Madera y resina. Tablas, piezas funcionales y trabajos a pedido." />
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>

<header class="nav">
  <div class="container nav-inner">
    <a class="brand" href="index.html">
      <span>by CAVS</span><span class="dot">•</span>
    </a>

    <nav class="nav-links">
      <a href="index.html">Inicio</a>
      <a class="active" href="blacksheep.html">Blacksheep</a>
      <a href="black-ivory.html">Black Ivory</a>
      <a href="about.html">Sobre CAVS</a>
      <a href="contact.html">Contacto</a>
    </nav>

    <a class="cta"
       href="https://wa.me/56973765456?text=Hola!%20Te%20escribo%20desde%20Blacksheep%20para%20consultar%20por%20una%20tabla."
       target="_blank" rel="noopener">
      Cotizar
    </a>
  </div>
</header>

<main>

  <!-- HERO (un bloque centrado) -->
  <section class="section">
    <div class="container">
      <div class="card pad brand-hero">

        <div class="kicker">Marca principal</div>

        <img src="assets/img/logos/blacksheep.png"
             alt="Blacksheep by CAVS"
             class="blacksheep-logo">

        <h1 class="h1">Blacksheep</h1>

        <p class="lead">
          Madera + resina. Tablas, piezas funcionales y trabajos a pedido.
        </p>

        <div class="pills">
          <span class="pill">Tablas asado</span>
          <span class="pill">Picoteo</span>
          <span class="pill">Encargos</span>
        </div>

        <div class="actions" style="margin-top:18px;">
          <a class="btn primary" href="#catalogo">Ver catálogo</a>
          <a class="btn" href="#encargos">Cómo encargar</a>
        </div>

      </div>
    </div>
  </section>

  <!-- CATÁLOGO -->
  <section class="section" id="catalogo">
    <div class="container">
      <h2 class="h2">Catálogo</h2>
      <p class="p">Piezas disponibles, vendidas y a pedido.</p>

      <div style="height:14px"></div>

      <div class="products" id="productsGrid"></div>
    </div>
  </section>

  <!-- ENCARGOS -->
  <section class="section" id="encargos">
    <div class="container">
      <h2 class="h2">Cómo encargar</h2>

      <div class="grid-3" style="margin-top:14px">
        <div class="card pad">
          <div class="kicker">1</div>
          <h3 style="margin:8px 0 6px">Define tu pieza</h3>
          <p class="p">Medidas, tipo de uso, madera y color de resina.</p>
        </div>

        <div class="card pad">
          <div class="kicker">2</div>
          <h3 style="margin:8px 0 6px">Confirmación</h3>
          <p class="p">Te envío propuesta y plazo. Reserva con abono.</p>
        </div>

        <div class="card pad">
          <div class="kicker">3</div>
          <h3 style="margin:8px 0 6px">Fabricación</h3>
          <p class="p">Proceso en taller y terminación final.</p>
        </div>
      </div>

      <div class="actions" style="margin-top:18px">
        <a class="btn primary"
           href="https://wa.me/56973765456?text=Hola!%20Quiero%20hacer%20un%20encargo%20Blacksheep."
           target="_blank" rel="noopener">
          Encargar por WhatsApp
        </a>
        <a class="btn" href="contact.html">Ir a Contacto</a>
      </div>
    </div>
  </section>

</main>

<footer class="footer">
  <div class="container">
    <div class="row">
      <div>© <span id="year"></span> by CAVS — Cristóbal Aboitiz</div>
      <div class="small-muted">
        <a href="index.html">Inicio</a> · <a href="contact.html">Contacto</a>
      </div>
    </div>
  </div>
</footer>

<script>
  document.getElementById("year").textContent = new Date().getFullYear();

  const DATA_URL = "assets/data/products.json";
  const IMG_BASE = "assets/img/tablas/";

  const formatCLP = (n) =>
    new Intl.NumberFormat("es-CL").format(n);

  function statusClass(status){
    const s = (status || "").toLowerCase();
    if (s.includes("dispon")) return "available";
    if (s.includes("vend")) return "sold";
    return "made";
  }

  function statusLabel(status){
    return status || "Encargo";
  }

  function isAvailable(status){
    const s = (status || "").toLowerCase();
    return s.includes("dispon");
  }

  function renderCard(p){
    const thumb = (p.images && p.images.length) ? (IMG_BASE + p.images[0]) : "";
    const tagCls = statusClass(p.status);

    return `
      <div class="product">
        <a class="cardlink" href="producto.html?id=${encodeURIComponent(p.id)}">
          <div class="img">
            ${thumb ? `<img src="${thumb}" alt="${p.title}" loading="lazy">` : `Imagen`}
          </div>

          <div class="body">
            <div class="meta" style="align-items:flex-start">
              <div>
                <p class="title">${p.title}</p>
                <div class="price">Precio: <strong>$${formatCLP(p.price || 0)}</strong></div>
                <div class="small-muted">Código: ${p.id}</div>
              </div>
              <span class="tag ${tagCls}">${statusLabel(p.status)}</span>
            </div>
          </div>
        </a>
      </div>
    `;
  }

  async function initCatalog(){
    const grid = document.getElementById("productsGrid");
    grid.innerHTML = "";

    const res = await fetch(DATA_URL, { cache: "no-store" });
    const all = await res.json();

    const bs = all.filter(p => (p.brand || "").toLowerCase() === "blacksheep");

    // Orden: disponibles primero, luego vendidas, y dentro de cada grupo por precio asc
    bs.sort((a,b) => {
      const aAvail = isAvailable(a.status) ? 0 : 1;
      const bAvail = isAvailable(b.status) ? 0 : 1;
      if (aAvail !== bAvail) return aAvail - bAvail;

      const ap = Number(a.price || 0);
      const bp = Number(b.price || 0);
      return ap - bp;
    });

    grid.innerHTML = bs.map(renderCard).join("");
  }

  initCatalog().catch(err => {
    console.error(err);
    document.getElementById("productsGrid").innerHTML =
      `<div class="card pad"><p class="p">No se pudo cargar el catálogo.</p></div>`;
  });
</script>

</body>
</html>
